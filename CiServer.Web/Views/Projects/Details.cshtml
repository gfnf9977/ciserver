@model CiServer.Core.Entities.Project
@{ ViewData["Title"] = "–î–µ—Ç–∞–ª—ñ –ø—Ä–æ—î–∫—Ç—É"; }

<div class="container">
    <h1>@Model.Name</h1>
    <p class="text-muted">Repo: <a href="@Model.RepoUrl" target="_blank">@Model.RepoUrl</a></p>

    <div class="mb-4">
        <a asp-action="StartBuild" asp-route-id="@Model.ProjectId" class="btn btn-success btn-lg">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ Build</a>
        <a asp-action="Index" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥</a>
        <a href="/Reports/Project/@Model.ProjectId" target="_blank" class="btn btn-info">üìä –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø–æ–≤–Ω–∏–π HTML-–∑–≤—ñ—Ç</a>
    </div>

    <h3>–Ü—Å—Ç–æ—Ä—ñ—è –∑–±—ñ—Ä–æ–∫</h3>
    <table class="table table-hover">
        <thead>
            <tr>
                <th>–î–∞—Ç–∞</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>Commit</th>
                <th>–î—ñ—ó</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var build in Model.Builds.OrderByDescending(b => b.StartTime))
            {
                string badgeClass = build.Status.ToString() switch
                {
                    "Success" => "bg-success",
                    "Failed" => "bg-danger",
                    "Running" => "bg-warning text-dark",
                    _ => "bg-secondary"
                };
                <tr>
                    <td>@build.StartTime.ToLocalTime()</td>
                    <td><span class="badge @badgeClass">@build.Status</span></td>
                    <td>@(string.IsNullOrEmpty(build.CommitHash) ? "-" : build.CommitHash)</td>
                    <td>
                        <a asp-action="BuildDetails" asp-route-id="@build.BuildId" class="btn btn-sm btn-outline-primary">–î–µ—Ç–∞–ª—ñ</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

<script>
    setTimeout(function() {
        window.location.reload(1);
    }, 30000);
</script>